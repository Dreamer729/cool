var _templateResolve=function(){var u=/(.)^/;var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"};var l={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"};var p=/\\|'|\r|\n|\t|\u2028|\u2029/g;window.__htmlEscape=function(e){if(e==null)return"";return(""+e).replace(new RegExp("[&<>\"/']","g"),function(e){return t[e]})};var e=function e(i,t,r){if(!i)return;var n;r={evaluate:/{{([\s\S]+?)}}/g,interpolate:/{{=([\s\S]+?)}}/g,escape:/{{-([\s\S]+?)}}/g};var a=new RegExp([(r.escape||u).source,(r.interpolate||u).source,(r.evaluate||u).source].join("|")+"|$","g");var o=0;var s="__p+='";i.replace(a,function(e,t,r,n,a){s+=i.slice(o,a).replace(p,function(e){return"\\"+l[e]});if(t){s+="'+\n((__t=("+t+"))==null?'':__htmlEscape(__t))+\n'"}if(r){s+="'+\n((__t=("+r+"))==null?'':__t)+\n'"}if(n){s+="';\n"+n+"\n__p+='"}o=a+e.length;return e});s+="';\n";if(!r.variable)s="with(obj||{}){\n"+s+"}\n";s="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{n=new Function(r.variable||"obj",s)}catch(e){e.source=s;throw e}if(t)return n(t);var e=function e(t){return n.call(this,t)};e.source="function("+(r.variable||"obj")+"){\n"+s+"}";return e};return e}();void function(o,_){var w=function e(){return!!_(".J-top-loginInfo").length};var e=function e(){return!!_(".J-jumpNext").length};var s=true;if(o.topLoginInfo||!w()){return}var t=_(".J-header-signInfo-2");if(t.length){var r=_(".J-userFeature").clone();t.replaceWith(r);_(".J-search-remove",r).remove()}var i=_(".J-search-bar-wrap");var u=_(".J-top-logged-2");var l=_(".J-header-inquiry-2");var p="user-signed";var c="zero-num";var f="middel-title";var N=function e(t,r,n){r=r||0;n=n||0;var a;if(t){a=r+n}else{a=n}if(a===0){u.addClass(f);l.addClass(f)}else{u.removeClass(f);l.removeClass(f)}if(r===0){u.addClass(c)}else{u.removeClass(c)}if(n===0){l.addClass(c)}else{l.removeClass(c)}if(t){i.addClass(p)}else{i.removeClass(p)}};var y={BUYER:"1",SUPPLIER:"2",FREESUPPLIER:"3"};var E=function e(t){if(!t.newMailNum&&!t.rfqNum&&!t.unReadNoticeNum||t.newMailNum){_(".J-top-tab").eq(0).trigger("click")}if(!t.newMailNum&&t.rfqNum){_(".J-top-tab").eq(1).trigger("click")}if(!t.newMailNum&&!t.rfqNum&&t.unReadNoticeNum){_(".J-top-tab").eq(2).trigger("click")}};var n=function e(t){if(!w()){return}t=_.extend({},{messages:[],rfqContents:[],noticeContents:[],newMailNum:0,rfqNum:0,userType:"",isForeign:true},t);var r=_(".J-focusChinaLink");if(t.userType===y.SUPPLIER||t.userType===y.FREESUPPLIER||t.userType===""&&!t.isForeign){r.attr("href","//www.focuschina.com/")}!!t.inquiryBasketNum?_(".nail-header .J-top-basketNum").show():_(".nail-header .J-top-basketNum").hide();_(".J-top-basketNum").html(t.inquiryBasketNum||0);var n=0;if(t.canManageInquiry){n=parseInt(t.newMailNum+t.rfqNum)||0}else{n=t.newMailNum||0}N(t.login,n,t.inquiryBasketNum);if(!t.login){_(".J-top-unlogin").show();_(".J-top-logged").hide();return}_(".J-top-unlogin").hide();_(".J-top-logged").show();var a=_(".J-top-username");if(!a.is(".J-top-named")&&t.name){a.text(t.name||"")}var i=_(".J-userFeature");if((t.userType==y.SUPPLIER||t.userType==y.FREESUPPLIER)&&!!_("#J-top-inquiry-tmpl").length){var o=_templateResolve(_("#J-top-inquiry-tmpl").html()),s=_templateResolve(_("#J-top-rfq-tmpl").html()),u=_templateResolve(_("#J-top-notice-tmpl").html());var l=_(".J-top-notice",i);_(".J-num",l).html(t.unReadNoticeNum||0);if(t.unReadNoticeNum){n+=t.unReadNoticeNum||0}_(".J-top-inquiry-block",i).html(o(t));_(".J-top-rfq-block",i).html(s(t));_(".J-top-notice-block",i).html(u(t));E(t)}_(".J-messageTotal").html(n);if(t.userType==y.BUYER){_(".J-buyer",i).show();_(".J-supplier",i).hide()}else if(t.userType==y.SUPPLIER){_(".J-supplier",i).show();_(".J-buyer",i).hide()}else if(t.userType===y.FREESUPPLIER){_(".J-supplier",i).show();_(".J-buyer",i).hide();_(".J-top-editor:not(:nth-child(2))",i).hide();_(".J-top-visit",i).hide();_(".J-top-visit",i).prev(".m-header-option-item.J-supplier").hide()}else{}var p=_(".J-top-inquiry",i);_(".J-num",p).html(t.newMailNum);if(t.newMailNum>0){var c=_(".J-top-inquiry a",i);c.attr("href",c.attr("data-unRead"))}var f=_(".J-top-rfq",i);_(".J-num",f).html(t.rfqNum||0);if(t.userType==y.BUYER){if(t.rfqNum&&t.rfqNum>0){var m=_(".J-buyer.J-top-rfq a",i);m.attr("href",m.attr("data-unRead"))}}if(!t.canManageInquiry){f.hide()}var h=_(".J-top-editor:not(:nth-child(2))",i);var d=_(".J-top-visit",i);if(t.userType==y.SUPPLIER&&!!t.canManageInfo){}else{h.hide();d.hide();_(".J-top-visit",i).prev(".m-header-option-item.J-supplier").hide()}var v="http://service.made-in-china.com/developing/activities/4992.html";var J="//www.made-in-china.com/special/forbuyerapp/";var g=null;if(t.login||t.name){if(t.userType===y.BUYER){g=J}else{g=v}}else{g=J}_(".J-header-app-link").attr("href",g)};var m=null;var h=function e(t,r){n(t);m=null;if(typeof r==="function"){r(t)}if(t.login&&window["sensors"]&&t.sensorsUserId){window.sensors.login(t.sensorsUserId)}else if(window["sensors"]){try{sensors.quick("isReady",function(){if(sensors.store.getDistinctId()=="EEnxEJQbMJmm_00"){sensors.logout(true)}})}catch(e){}}};var a=function e(t,r){if(!w()){return}var n={};var a=_(".J-top-loginInfo").attr("data-useless");if(a){n.useless=a}if(!!_(".J-top-head-type").length&&_(".J-top-head-type").val()==="vo"){n.envo=true}_.extend(true,n,t);var i="//www.made-in-china.com/head.do?xcase=getHead&callback=?";if(o.__HEADER_USER_INFO__&&s){s=false;o.__HEADER_USER_INFO__.then(function(e){h(e,r)});return}m&&m.abort();m=_.ajax({url:i,dataType:"jsonp",data:n,timeout:100*1e3,success:function e(t){h(t,r)},error:function e(){m=null}})};var d=null;var v=function e(t,r){if(!w()){return}var n={};_.extend(true,n,t);var a="//www.made-in-china.com/head.do?xcase=getBasketNum&callback=?";d&&d.abort();d=_.ajax({url:a,dataType:"jsonp",data:n,timeout:100*1e3,success:function e(t){if(!w()){return}_(".J-top-basketNum").html(t.basketNum||0);N(false,0,t.basketNum);d=null;if(typeof r==="function"){r(t)}},error:function e(){d=null},complete:function e(){if(window["sensors"]){try{sensors.quick("isReady",function(){if(sensors.store.getDistinctId()=="EEnxEJQbMJmm_00"){sensors.logout(true)}})}catch(e){}}}})};_(".J-top-tab").each(function(e,t){_(this).click(function(){_(".J-top-tab").removeClass("selected");_(this).addClass("selected");_(".J-top-block").hide();_(".J-top-block").eq(e).show()})});if(w()){var J=encodeURIComponent(window.location.href);if(e()){_(".J-top-signIn").attr("href",_(".J-top-signIn").attr("href")+"?jumpNext=1&baseNextPage="+J)}else{_(".J-top-signIn").attr("href",_(".J-top-signIn").attr("href")+"?baseNextPage="+J)}_(".J-top-signOut").attr("href",_(".J-top-signOut").attr("href")+"&baseNextPage="+J)}if(!("__IS_USER_LOGED__"in o)||o.__IS_USER_LOGED__){a()}else{v()}var g=function e(t){a(null,t)};o.topLoginInfo={update:n,request:a,getStatus:g}}.call(this,this,this.jQuery||this.Zepto);
//# sourceMappingURL=../../../../__sources__/common/js/business/global/topLoginInfo_249082d0.js.map
